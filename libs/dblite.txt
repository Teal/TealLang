require json;  // 导入文件
require ./mycode;    // 导入文件
require './files a/mycode';    // 导入文件
File = require('File').File;

DbLite.new = {
	if(@path) {
		this.data = Json.parse(File.read(@path, @encoding));
	} else {
		this.data = Json.new();
	}
};

DbLite.select = {
	return this.data.each {
		if(out.@condition(@value)) {
			return @value;
		}
	}
};

DbLite.update = {
	return this.data.each {
		if(out.@condition(@value)) {
			@value = out.@value
		}
	}
};

DbLite.delete = {
	return this.update(condition: @condition, value: null);
};

DbLite.save = {
	File.write(@path, Json.stringify(this.data), @encoding);
};

class DbLite {
	
	DbLite = {
		if(@path) {
			this.data = Json.parse(File.read(@path, @encoding));
		} else {
			this.data = Json.new();
		}
	}
	
	select = {
		return this.data.each {
			if(out.@condition(@value)) {
				return @value;
			}
		}
	}
	
	update = {
		return this.data.each {
			if(out.@condition(@value)) {
				return @value;
			}
		}
	}
	
	delete = {
		return this.update(condition: @condition, value: null);
	}
	
	save = {
		File.write(@path, Json.stringify(this.data), @encoding);
	}

}


